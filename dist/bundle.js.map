{"version":3,"sources":["webpack://MorrowindndReact/./src/NPCMaker/ImageChooser.module.scss","webpack://MorrowindndReact/./src/NPCMaker/NPCTagChooser.module.scss","webpack://MorrowindndReact/./src/NPCMaker/NPCViewer.module.scss","webpack://MorrowindndReact/./src/Util/ItemViewer.module.scss","webpack://MorrowindndReact/./node_modules/css-loader/dist/runtime/api.js","webpack://MorrowindndReact/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://MorrowindndReact/./node_modules/object-assign/index.js","webpack://MorrowindndReact/./node_modules/react/cjs/react-jsx-runtime.production.min.js","webpack://MorrowindndReact/./node_modules/react/jsx-runtime.js","webpack://MorrowindndReact/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://MorrowindndReact/external \"React\"","webpack://MorrowindndReact/webpack/bootstrap","webpack://MorrowindndReact/webpack/runtime/compat get default export","webpack://MorrowindndReact/webpack/runtime/define property getters","webpack://MorrowindndReact/webpack/runtime/hasOwnProperty shorthand","webpack://MorrowindndReact/./src/Util/RefreshButton.js","webpack://MorrowindndReact/./src/Util/Selector.js","webpack://MorrowindndReact/./src/NPCMaker/NPCMakerUtils.js","webpack://MorrowindndReact/./src/NPCMaker/NameHelper.js","webpack://MorrowindndReact/./src/NPCMaker/NPCTagChooser.module.scss?2123","webpack://MorrowindndReact/./src/NPCMaker/NPCTagChooser.jsx","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"AppContext\"]","webpack://MorrowindndReact/./src/NPCMaker/VoiceChooser.jsx","webpack://MorrowindndReact/./src/NPCMaker/NPCViewer.module.scss?f93b","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"Util\"]","webpack://MorrowindndReact/./src/NPCMaker/ImageChooser.module.scss?9bd1","webpack://MorrowindndReact/./src/NPCMaker/ImageChooser.jsx","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"FolderHelper\"]","webpack://MorrowindndReact/./src/NPCMaker/NPCViewer.jsx","webpack://MorrowindndReact/./src/NPCMaker/NPCTypedMaker.jsx","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"FilesHelper\"]","webpack://MorrowindndReact/./src/NPCMaker/NPCMakerInitialDirSelector.jsx","webpack://MorrowindndReact/./src/NPCMaker/NPCMakerComponent.jsx","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"ReactApplication\"]","webpack://MorrowindndReact/./src/NPCMaker/NPCMaker.js","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"Logging\"]","webpack://MorrowindndReact/./src/Util/LoggerFactory.js","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"DropHelper\"]","webpack://MorrowindndReact/./src/Enchanting/EnchantConfig.js","webpack://MorrowindndReact/./src/Util/ItemViewer.module.scss?7ba1","webpack://MorrowindndReact/./src/Util/ItemViewer.jsx","webpack://MorrowindndReact/./src/Constants/SpellConstants.js","webpack://MorrowindndReact/./src/Enchanting/Enchanter.js","webpack://MorrowindndReact/./src/Enchanting/EnchantingFormComponent.jsx","webpack://MorrowindndReact/./src/Enchanting/EnchantForm.js","webpack://MorrowindndReact/./src/Enchanting/SoulGems/SoulGemPropertiesComponent.jsx","webpack://MorrowindndReact/./src/Item/ItemPropertiesComponent.jsx","webpack://MorrowindndReact/./src/Item/ItemProperties.js","webpack://MorrowindndReact/./src/Util/FlagHelper.js","webpack://MorrowindndReact/./src/Enchanting/SoulGems/SoulGemUIBodge.js","webpack://MorrowindndReact/./src/Enchanting/SoulGems/SoulGemHelper.js","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"PackHelper\"]","webpack://MorrowindndReact/./src/RollTable/Rolling/TableItemRollData.js","webpack://MorrowindndReact/./src/RollTable/Rolling/TableSpellHelper.js","webpack://MorrowindndReact/./src/RollTable/Rolling/TableGoldHelper.js","webpack://MorrowindndReact/./src/RollTable/Rolling/tableHelperUtils.js","webpack://MorrowindndReact/./src/RollTable/Rolling/TableWeaponEnchantHelper.js","webpack://MorrowindndReact/./src/RollTable/Rolling/TableHelper.js","webpack://MorrowindndReact/./src/RollTable/Rolling/TableItemHelper.js","webpack://MorrowindndReact/./src/RollTable/Rolling/TableTableHelper.js","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"AsyncHelper\"]","webpack://MorrowindndReact/./src/RollTable/Rolling/TableRoller.js","webpack://MorrowindndReact/./src/RollTable/UI/TableModifierComponent.jsx","webpack://MorrowindndReact/./src/RollTable/UI/TableModifier.js","webpack://MorrowindndReact/./src/Loot/TokenLootGenerator/TokenLootGenerator.js","webpack://MorrowindndReact/./src/Loot/TokenLootGenerator/TokenLootSetupComponent.jsx","webpack://MorrowindndReact/./src/Loot/TokenLootGenerator/TokenLootUI.js","webpack://MorrowindndReact/external [\"FoundryReactCore\",\"Util\",\"ItemHelper\"]","webpack://MorrowindndReact/./src/Loot/TokenLootAggregator/LootAggregator.js","webpack://MorrowindndReact/./src/Token/TokenTraitModifier.js","webpack://MorrowindndReact/./src/Item/ItemPropertiesUI.js"],"names":["___CSS_LOADER_EXPORT___","push","module","id","locals","exports","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","_i","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","next","done","value","err","_iterableToArrayLimit","o","minLen","n","prototype","call","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","getOwnPropertySymbols","hasOwnProperty","propIsEnumerable","propertyIsEnumerable","toObject","val","assign","test1","String","getOwnPropertyNames","test2","fromCharCode","test3","split","forEach","letter","keys","shouldUseNative","target","symbols","to","s","arguments","key","f","g","for","h","m","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","ref","__self","__source","q","c","a","k","b","d","e","l","defaultProps","$$typeof","type","props","_owner","current","jsx","jsxs","memo","getTarget","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","React","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","getter","__esModule","definition","defineProperty","enumerable","get","prop","RefreshButton","onClick","className","Selector","values","setValue","labelFunction","includeNull","v","label","selected","onChange","genders","races","isIn","array","some","toLowerCase","NPCImage","image","path","getTags","backup","race","gender","other","substring","indexOf","part","isNaN","getRandomName","choices","generateName","matchProperty","choice","ignore","NPCChoices","ignoreNoGender","ignoreNoRace","match","oRace","oGender","oOther","every","oValue","images","x","setOther","copy","newValues","raceMap","random","things","Math","floor","parts","Data","nr","tlc","ng","firstName","lastName","increment","newVal","setCurrent","sort","r","checked","NPCTagChooser","files","filtered","setChoice","blocks","file","getTagCounts","styles","title","FoundryReactCore","Util","AppContext","generateVoice","voice","VoiceData","VoiceDisplay","refreshVoice","ImageChooser","setIndex","setRandom","max","min","FolderHelper","NPCViewer","appContext","useContext","component","imageComponent","useState","refresh","useCallback","randomIndex","useEffect","src","width","useImageChooser","nameComponent","imageRace","imageGender","setName","setRace","setGender","dependants","refreshName","useName","voiceComponent","setVoice","useVoice","async","folder","setupFolder","actorData","img","details","biography","Actor","create","renderSheet","close","NPCTypedMaker","dir","setDir","setFiles","dirs","setDirs","newFiles","newDirs","browse","FilesHelper","NPCMakerInitialDirSelector","dirMap","listFiles","storage","bucket","run","NPCMakerComponent","ReactApplication","loadedStart","gameSettings","getElementById","getElementsByClassName","newButton","innerText","onclick","SimpleReactApplication","height","render","Hooks","on","setTimeout","Logging","LoggerFactory","getLoggerFactory","getLogger","feature","DropHelper","EnchantConfig","EnchantCastableSize","charges","weight","difficultyMod","getRandomCharge","chargeTypes","CastableSizes","reduce","newRand","EnchantCastableSpellLevel","level","forSpellLevel","CastableSpellLevels","find","soulSize","SoulSize","size","instance","SoulSizes","ItemViewer","children","sheet","SpellLevelValues","0","1","2","3","4","5","6","7","8","9","log","Minor","ChargeTypes","valueRarity","valueMin","getRarity","getEnchantData","itemData","spellData","enchantData","_id","spell","newName","spellLevel","newValue","price","calculateEnchantValueAdd","nestedData","description","chat","unidentified","consumableType","quantity","uses","per","armor","rarity","permission","flags","isSpellEnchantable","morrowindnd","enchanter_data","EnchantingFormComponent","ItemClass","sizes","App","setSpell","setCharges","onDropped","onDrop","Item","disabled","SoulGemPropertiesComponent","soulGemState","setSoulGemState","isSoulGem","sizeObj","fillSize","fillSizeObj","ItemPropertiesComponent","flag","setFlag","app","state","setState","soulGem","addMenuItem","object","game","user","isGM","icon","callback","owner","canFix","ITEM_FLAG","getProperties","defaultFlag","getFlag","newFlag","targets","actor","deadActor","cr","includes","getSoulLevel","gem","items","soulInfo","qty","deleteOwnedItem","newGemData","createOwnedItem","fillActorSoulGem","PackHelper","TableItemRollData","applyItemModification","getItemData","clone","getModifications","CurrencyLevel","CurrencyLevels","pp","gp","sp","cp","CurrencyItem","fun","resultObj","existing","multiply","amount","add","ov","isEmpty","modifications","currency","existingValue","specialFilters","_","folders","getSubFolders","WeaponEnchantment","weaponData","attackBonus","damageParts","prefix","suffix","valueAdd","valueMult","damage","round","parseFloat","parseInt","TextHelpers","args","roll","Roll","total","filterItem","filters","debug","filteredResults","packSpells","loadPackItems","failOnNoPack","byName","getAllSpells","scroll","createScrollFromSpell","table","tables","t","results","doRollTable","flatMap","rollString","rollResult","number","generator","fill","Promise","nAsync","damages","damageTypes","damageType","damageSplit","damageTypeSplit","getArguments","text","substr","specialArguments","startsWith","filterArguments","argument","field","comparator","compareFunction","getCompareFunction","specialFilterName","getFilter","getProperty","parseArguments","AsyncHelper","EncapsulatingRollData","rolls","modifiers","acc","mods","rollTable","tableId","resultId","collection","helper","getRollData","pack","packs","getEntity","error","getRollTableData","TableModifierComponent","setTable","entities","openTableModifier","ACTOR_FLAG","TokenLootSetupComponent","rollTables","setRollTables","rollTableIds","removeTable","slot","newRollTables","addTable","updateTable","newTables","rolltable","token","rollTableId","flatData","modObj","html","isToken","isPC","ItemHelper","FLAG","BlacklistedTypes","_sheetClass","isLootSheet","canvas","tokens","controlled","lootContainer","container","canBeLooted","actors","actorId","getBaseActor","mergedItems","mergeItemData","getCurrency","forEachAsync","lootTokens","unsetFlag","traits","ac","replace","matchedTraits","traitName","updateData","trait"],"mappings":"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","file":"bundle.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"._2dQbrDUBTnIetX940qjTOJ{display:flex;flex-direction:row;justify-content:space-between}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/NPCMaker/ImageChooser.module.scss\"],\"names\":[],\"mappings\":\"AAAA,yBACE,YAAA,CACA,kBAAA,CACA,6BAAA\",\"sourcesContent\":[\".buttonHolder {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n  justify-content: space-between;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"buttonHolder\": \"_2dQbrDUBTnIetX940qjTOJ\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"._2gtOv9LhnGQMYe_Hs941Q5{display:flex;flex-direction:row}._1_iWJyR4OsvdR-z06Ca7x2{flex-grow:1}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/NPCMaker/NPCTagChooser.module.scss\"],\"names\":[],\"mappings\":\"AAAA,yBACE,YAAA,CACA,kBAAA,CAGF,yBACE,WAAA\",\"sourcesContent\":[\".category_holder {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n}\\r\\n\\r\\n.category {\\r\\n  flex-grow: 1;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"category_holder\": \"_2gtOv9LhnGQMYe_Hs941Q5\",\n\t\"category\": \"_1_iWJyR4OsvdR-z06Ca7x2\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"._8EYArT6NHU0shbsHw1S7o{display:flex;flex-direction:row}._2XuLUhBnpR9C4Rm0zHJ_kT{display:flex;flex-direction:column;flex-grow:1;justify-content:space-between}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/NPCMaker/NPCViewer.module.scss\"],\"names\":[],\"mappings\":\"AAAA,wBACE,YAAA,CACA,kBAAA,CAGF,yBACE,YAAA,CACA,qBAAA,CACA,WAAA,CACA,6BAAA\",\"sourcesContent\":[\".viewer {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n}\\r\\n\\r\\n.attributes {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  flex-grow: 1;\\r\\n  justify-content: space-between;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"viewer\": \"_8EYArT6NHU0shbsHw1S7o\",\n\t\"attributes\": \"_2XuLUhBnpR9C4Rm0zHJ_kT\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".gYWJmC7std3wA-CbHVzs3{display:flex;flex-direction:row;height:32px;width:100%}.gMY4_reM5UHaKyD-hBlSf{max-width:32px;max-height:32px}._2XMZWZ8QzDkKjoD81NWHX_{flex-grow:1}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/Util/ItemViewer.module.scss\"],\"names\":[],\"mappings\":\"AAAA,uBACE,YAAA,CACA,kBAAA,CACA,WAAA,CACA,UAAA,CAGF,uBACE,cAAA,CACA,eAAA,CAGF,yBACE,WAAA\",\"sourcesContent\":[\".viewer {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n  height: 32px;\\r\\n  width: 100%\\r\\n}\\r\\n\\r\\n.image {\\r\\n  max-width: 32px;\\r\\n  max-height: 32px;\\r\\n}\\r\\n\\r\\n.name {\\r\\n  flex-grow: 1\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"viewer\": \"gYWJmC7std3wA-CbHVzs3\",\n\t\"image\": \"gMY4_reM5UHaKyD-hBlSf\",\n\t\"name\": \"_2XMZWZ8QzDkKjoD81NWHX_\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/** @license React v17.0.1\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';require(\"object-assign\");var f=require(\"react\"),g=60103;exports.Fragment=60107;if(\"function\"===typeof Symbol&&Symbol.for){var h=Symbol.for;g=h(\"react.element\");exports.Fragment=h(\"react.fragment\")}var m=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n=Object.prototype.hasOwnProperty,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,k){var b,d={},e=null,l=null;void 0!==k&&(e=\"\"+k);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(l=a.ref);for(b in a)n.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:g,type:c,key:e,ref:l,props:d,_owner:m.current}}exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","module.exports = React;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","export default function RefreshButton({onClick}) {\r\n    return <i className=\"fas fa-redo\" onClick={onClick} />\r\n}","export default function Selector({values, value, setValue, labelFunction=(s)=>`${s}`, includeNull=true}) {\r\n    let map = {}\r\n    values.forEach((v)=>{\r\n        let label = labelFunction(v)\r\n        if(map[label]) throw Error(\"Value already exists for \" + label + \" - \" + v)\r\n        map[label] = v\r\n    })\r\n    let selected = value === null ? \"\" : labelFunction(value)\r\n    return <select value={selected} onChange={(e)=>setValue(map[e.target.value])}>\r\n        {includeNull ? <option value=\"\" /> : null}\r\n        {values.map((v)=>{\r\n            let label = labelFunction(v)\r\n            return <option key={label} value={label}>{label}</option>\r\n        })}\r\n    </select>\r\n}","import {generateName} from \"./NameHelper\";\r\n\r\nexport const genders = [\"male\", \"female\"]\r\nexport const races = [\"altmer\", \"argonian\", \"bosmer\", \"breton\", \"dunmer\", \"imperial\", \"khajiit\", \"nord\", \"orc\", \"redguard\"]\r\n\r\nexport function isIn(value, array) {\r\n    return array.some((v)=>v.toLowerCase() === value.toLowerCase())\r\n}\r\n\r\nexport class NPCImage {\r\n    constructor(image) {\r\n        this.image = image;\r\n        this.path = image.path\r\n        this.name = image.name;\r\n    }\r\n\r\n    getTags(backup = {}) {\r\n        let name = this.name\r\n        let race = backup.race || null\r\n        let gender = backup.gender || null\r\n        let other = []\r\n        let split = name.substring(0, name.indexOf(\".\")).split(\"_\")\r\n        split.forEach((part,index)=>{\r\n            if(!isNaN(part)) return\r\n            if(isIn(part, genders)) gender = part.toLowerCase()\r\n            else if(isIn(part, races)) race = part.toLowerCase()\r\n            else other.push(part.toLowerCase())\r\n        })\r\n        return {race, gender, other}\r\n    }\r\n\r\n    getRandomName(choices) {\r\n        let {race, gender} = this.getTags(choices)\r\n        return generateName(race, gender)\r\n    }\r\n}\r\n\r\nfunction matchProperty(value, choice, ignore = true) {\r\n    if(value == null) {\r\n        if(ignore) {\r\n            return false\r\n        } else {\r\n            return choice == null || choice == \"None\"\r\n        }\r\n    } else if(choice == null) {\r\n        return true\r\n    } else {\r\n        return value === choice\r\n    }\r\n}\r\n\r\nexport class NPCChoices {\r\n    constructor({race= null, gender= null, other= [], ignoreNoGender= false, ignoreNoRace = false} = {}) {\r\n        this.data = {race, gender, other, ignoreNoGender, ignoreNoRace}\r\n        Object.assign(this, this.data)\r\n    }\r\n\r\n    match(image) {\r\n        let {race, gender, other} = image.getTags()\r\n        let {race: oRace, gender: oGender, other: oOther, ignoreNoRace, ignoreNoGender} = this.data\r\n        return matchProperty(race, oRace, ignoreNoRace) && matchProperty(gender, oGender, ignoreNoGender) && oOther.every(oValue=>other.some(value=>value === oValue))\r\n    }\r\n\r\n    filter(images) {\r\n        return images.filter(x=>this.match(x))\r\n    }\r\n\r\n    setOther(key, value) {\r\n        if(value) {\r\n            if(!this.data.other.some(x=>x === key)) {\r\n                return this.copy({other: [...this.data.other, key]})\r\n            } else {\r\n                return this;\r\n            }\r\n        } else {\r\n            return this.copy({other: this.data.other.filter(x=>x !== key)})\r\n        }\r\n    }\r\n\r\n    copy(newValues) {\r\n        return new NPCChoices({...this.data, ...newValues})\r\n    }\r\n}","import Data from \"./NPCData.json\"\r\nimport {useCallback, useEffect, useState} from \"react\";\r\nimport RefreshButton from \"../Util/RefreshButton\";\r\nimport Selector from \"../Util/Selector\";\r\nimport {genders, races} from \"./NPCMakerUtils\";\r\n\r\nconst raceMap = {\r\n    \"dark elf\": \"dunmer\",\r\n    \"wood elf\": \"bosmer\",\r\n    \"high elf\": \"altmer\"\r\n}\r\n\r\nfunction map(map, choice) {\r\n    let tlc = choice.toLowerCase()\r\n    return map[tlc] || tlc\r\n}\r\n\r\nfunction filter(data, race, gender) {\r\n    let nr = map(raceMap, data.race)\r\n    let ng = data.gender.toLowerCase()\r\n    return (race == null || race === nr) && (gender == null || gender === ng)\r\n}\r\n\r\nfunction random(things) {\r\n    let index = Math.floor(Math.random() * things.length)\r\n    return things[index]\r\n}\r\n\r\nexport function generateName(race, gender) {\r\n    let parts = Data.filter((i)=>filter(i, race, gender))\r\n    let firstName = random(parts).firstName\r\n    let lastName = random(parts).lastName\r\n    return `${firstName} ${lastName}`\r\n}\r\n\r\nexport function useName(image, choice) {\r\n    let {race: imageRace, gender: imageGender} = image ? image.getTags(choice) : {}\r\n    let [name, setName] = useState(()=>\"\")\r\n    let [race, setRace] = useState(\"dunmer\")\r\n    let [gender, setGender] = useState(null)\r\n    let dependants = [imageRace, imageGender, race, gender]\r\n    let refreshName = useCallback(()=>{\r\n        let raceToUse = imageRace || race\r\n        let genderToUse = imageGender || gender\r\n        setName(generateName(raceToUse, genderToUse))\r\n    }, dependants)\r\n    useEffect(refreshName, dependants)\r\n    let component = <div>\r\n        {name}\r\n        {imageRace == null ? <Selector values={races} value={race} setValue={setRace} /> : null }\r\n        {imageGender == null ? <Selector values={genders} value={gender} setValue={setGender} /> : null }\r\n        <RefreshButton onClick={refreshName} />\r\n    </div>\r\n    return {name, component}\r\n}","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./NPCTagChooser.module.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import {genders, races} from \"./NPCMakerUtils\";\r\nimport styles from \"./NPCTagChooser.module.scss\"\r\n\r\nfunction increment(obj, part, ignore) {\r\n    if(part == null) {\r\n        if(!ignore)\r\n            obj[\"None\"] = (obj[\"None\"] || 0) + 1\r\n    } else {\r\n        let newVal = obj[part] || 0\r\n        obj[part] = newVal + 1\r\n    }\r\n}\r\n\r\nfunction getTagCounts(files, {ignoreNoRace, ignoreNoGender}) {\r\n    let blocks = {races: {}, genders: {}, other: {}}\r\n    files.forEach((file)=>{\r\n        let {race, gender, other} = file.getTags()\r\n        increment(blocks.races, race, ignoreNoRace)\r\n        increment(blocks.genders, gender, ignoreNoGender)\r\n        other.forEach(part=>increment(blocks.other, part))\r\n    })\r\n    return blocks\r\n}\r\n\r\nfunction Selector({options, current, setCurrent}) {\r\n    let isChecked = (f)=>{\r\n        if(current === null) return false;\r\n        if(typeof(current) === \"object\") {\r\n            return current[f]\r\n        } else {\r\n            return current === f\r\n        }\r\n    }\r\n    return <div>\r\n        {Object.keys(options).sort().map((r)=><div key={r}><span>\r\n            <input type=\"checkbox\" checked={isChecked(r)} onChange={(e)=>setCurrent({c: r, s: e.target.checked})} />\r\n            {r} - {options[r]}\r\n        </span></div>)}\r\n    </div>\r\n}\r\n\r\nexport default function NPCTagChooser({files, filtered, choice, setChoice}) {\r\n    let blocks = getTagCounts(filtered, choice)\r\n\r\n    return <div>\r\n        <span className={styles.category_holder}>\r\n            <div className={styles.category}>\r\n                <h3>Race</h3>\r\n                <input type=\"checkbox\" checked={choice.ignoreNoRace} onChange={(e)=>setChoice(choice.copy({ignoreNoRace: e.target.checked}))}/>Ignore No Race\r\n                <Selector options={blocks.races} current={choice.race} setCurrent={({c, s})=>setChoice(choice.copy({race: s?c:null}))} />\r\n            </div>\r\n            <div className={styles.category}>\r\n                <h3>Gender</h3>\r\n                <input type=\"checkbox\" checked={choice.ignoreNoGender} onChange={(e)=>setChoice(choice.copy({ignoreNoGender: e.target.checked}))}/>Ignore No Gender\r\n                <Selector title=\"Gender\" options={blocks.genders} current={choice.gender} setCurrent={({c,s})=>setChoice(choice.copy({gender: s?c:null}))} />\r\n            </div>\r\n            <div className={styles.category}>\r\n                <h3>Other</h3>\r\n                <Selector title=\"Other\" options={blocks.other} current={choice.other} setCurrent={({c,s})=>setChoice(choice.setOther(c, s))} />\r\n            </div>\r\n        </span>\r\n    </div>\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.AppContext;","import VoiceData from \"./VoiceData.json\"\r\nimport {useCallback, useState} from \"react\";\r\nimport RefreshButton from \"../Util/RefreshButton\";\r\n\r\nfunction generateVoice() {\r\n    let voice = {}\r\n    Object.keys(VoiceData).forEach(key=>{\r\n        let array = VoiceData[key]\r\n        let choice = Math.floor(Math.random() * array.length)\r\n        voice[key] = array[choice]\r\n    })\r\n    return voice\r\n}\r\n\r\nfunction VoiceDisplay({voice, refreshVoice}) {\r\n    return <div>\r\n        <table><tbody>{Object.keys(voice).map(x=><tr key={x}><td>{x}</td><td>{voice[x]}</td></tr>)}</tbody></table>\r\n        <RefreshButton onClick={refreshVoice} />\r\n    </div>\r\n}\r\n\r\nexport function useVoice() {\r\n    let [voice, setVoice] = useState(generateVoice())\r\n    let refresh = useCallback(()=>{\r\n        setVoice(generateVoice())\r\n    })\r\n    let component = <VoiceDisplay voice={voice} refreshVoice={refresh} />\r\n    let table = `<table><tbody>${Object.keys(voice).map(x=>`<tr><td>${x}</td><td>${voice[x]}</td></tr>`).join(\"\")}</tbody></table>`\r\n    return {voice: table, component}\r\n}","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./NPCViewer.module.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.Util;","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./ImageChooser.module.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import {useCallback, useEffect, useState} from \"react\";\r\nimport {randomIndex} from \"@darkholme/foundry-react-core/src/Util/Util\";\r\nimport RefreshButton from \"../Util/RefreshButton\";\r\nimport styles from \"./ImageChooser.module.scss\"\r\n\r\nfunction ImageChooser({length, index, setIndex, setRandom}) {\r\n    return <div className={styles.buttonHolder}>\r\n        <i className=\"fas fa-chevron-left\" onClick={()=>setIndex(Math.max(index - 1, 0))}/>\r\n        {index + 1} / {length}\r\n        <i className=\"fas fa-chevron-right\" onClick={()=>setIndex(Math.min(index + 1, length - 1))}/>\r\n        <RefreshButton onClick={setRandom} />\r\n    </div>\r\n}\r\n\r\nexport function useImageChooser(images) {\r\n    let [index, setIndex] = useState(0)\r\n    let refresh=useCallback(()=>setIndex(randomIndex(images)), [images])\r\n    useEffect(refresh, [images])\r\n    let image = images[index]\r\n    let component;\r\n    if(image) {\r\n        component = <div>\r\n            <img src={image.path} width=\"256px\"/>\r\n            <ImageChooser length={images.length} index={index} setIndex={setIndex} setRandom={refresh} />\r\n        </div>\r\n    } else {\r\n        component = <div>No images</div>\r\n    }\r\n    return {image, component}\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.FolderHelper;","import {useContext} from \"react\";\r\nimport AppContext from \"@darkholme/foundry-react-core/src/Util/AppContext\";\r\nimport {useName} from \"./NameHelper\";\r\nimport {useVoice} from \"./VoiceChooser\";\r\nimport styles from \"./NPCViewer.module.scss\"\r\nimport {useImageChooser} from \"./ImageChooser\";\r\nimport {setupFolder} from \"@darkholme/foundry-react-core/src/Util/FolderHelper\";\r\n\r\nexport default function NPCViewer({filtered, choice}) {\r\n    let appContext = useContext(AppContext)\r\n    let {image, component: imageComponent} = useImageChooser(filtered)\r\n    let {name, component: nameComponent} = useName(image, choice)\r\n    let {voice, component: voiceComponent} = useVoice()\r\n\r\n    if(image == null) {\r\n        return <div>\r\n            No possible NPC\r\n        </div>\r\n    } else {\r\n        return <div className={styles.viewer}>\r\n            {imageComponent}\r\n            <div className={styles.attributes}>\r\n                {nameComponent}\r\n                {voiceComponent}\r\n                <button onClick={async ()=>{\r\n                    let folder = await setupFolder(\"npcs/generated\", \"Actor\")\r\n                    let actorData = {\r\n                        name,\r\n                        folder,\r\n                        type: \"npc\",\r\n                        img: image.path,\r\n                        data: {\r\n                            details: {\r\n                                biography: {\r\n                                    value: voice\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    await Actor.create(actorData, {renderSheet: true})\r\n                    appContext.close()\r\n                }}>Save</button>\r\n            </div>\r\n        </div>\r\n    }\r\n}","import {useEffect, useState} from \"react\";\r\nimport {NPCChoices, NPCImage} from \"./NPCMakerUtils\";\r\nimport NPCTagChooser from \"./NPCTagChooser\";\r\nimport NPCViewer from \"./NPCViewer\";\r\n\r\n\r\nexport default function NPCTypedMaker({dir, setDir}) {\r\n    let [files, setFiles] = useState(null)\r\n    let [dirs, setDirs] = useState([])\r\n    let [choice, setChoice] = useState(new NPCChoices())\r\n    useEffect(async ()=>{\r\n        let {files: newFiles, dirs: newDirs} = await dir.browse()\r\n        setFiles(newFiles.map(f=>new NPCImage(f)))\r\n        setDirs(newDirs)\r\n    }, [dir])\r\n\r\n    if(files === null) {\r\n        return \"Loading\"\r\n    } else {\r\n        let filtered = choice.filter(files)\r\n        return <div>\r\n            {dirs.map(d=><button key={d.name} onClick={()=>setDir(d)}>{d.name}</button>)}\r\n            <NPCTagChooser files={files} filtered={filtered} choice={choice} setChoice={setChoice} />\r\n            <NPCViewer filtered={filtered} choice={choice} />\r\n        </div>\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.FilesHelper;","import {useEffect, useState} from \"react\";\r\nimport {listFiles} from \"@darkholme/foundry-react-core/src/Util/FilesHelper\";\r\n\r\nexport default function NPCMakerInitialDirSelector({setDir}) {\r\n    let [dirs, setDirs] = useState(null)\r\n\r\n    useEffect(()=>{\r\n        let run = async ()=>{\r\n            let {dirMap} = await listFiles({storage: \"s3\", target: \"mobs\", bucket: \"foundry-darkcraft-bucket\"})\r\n            setDirs(dirMap)\r\n        }\r\n        run()\r\n    }, [setDir])\r\n    if(dirs == null) {\r\n        return \"Loading...\"\r\n    } else {\r\n        return <div>\r\n            {Object.keys(dirs).map(dir=><button key={dir} onClick={()=>setDir(dirs[dir])}>{dir}</button> )}\r\n        </div>\r\n    }\r\n}","import {useEffect, useState} from \"react\";\r\nimport {generateName} from \"./NameHelper\";\r\nimport NPCTypedMaker from \"./NPCTypedMaker\";\r\nimport NPCMakerInitialDirSelector from \"./NPCMakerInitialDirSelector\";\r\n\r\nfunction TypeSelector({types, selectType}) {\r\n    return (<div>\r\n        {types.map(type=>(\r\n            <button key={type} onClick={()=>selectType(type)}>\r\n                {type}\r\n            </button>\r\n        ))}\r\n    </div>);\r\n}\r\n\r\n\r\n\r\nexport default function NPCMakerComponent() {\r\n    let [dir, setDir] = useState(null)\r\n\r\n    if(dir != null) {\r\n        return <div>\r\n            {dir.name} - <button onClick={()=>setDir(null)}>X</button>\r\n            <NPCTypedMaker dir={dir} setDir={setDir} />\r\n        </div>\r\n    } else {\r\n        return <div>\r\n            <NPCMakerInitialDirSelector setDir={setDir}/>\r\n        </div>\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.ReactApplication;","import NPCMakerComponent from \"./NPCMakerComponent\";\r\nimport {SimpleReactApplication} from \"@darkholme/foundry-react-core/src/Util/ReactApplication\";\r\nimport React from \"react\";\r\n\r\nfunction loadedStart() {\r\n    let gameSettings = document.getElementById(\"actors\").getElementsByClassName(\"directory-footer\").item(0)\r\n    if(!gameSettings) return;\r\n    if(gameSettings.getElementsByClassName('morrowindnd-generate-npc').length > 0) return\r\n    let newButton = document.createElement(\"button\")\r\n    newButton.innerText = \"Generate NPC\"\r\n    newButton.className = \"morrowindnd-generate-npc\"\r\n    newButton.onclick = ()=>new SimpleReactApplication(<NPCMakerComponent />, {width:700, height: 800}).render(true)\r\n    gameSettings.appendChild(newButton)\r\n}\r\n\r\nHooks.on(\"renderActorDirectory\", loadedStart)\r\n\r\nsetTimeout(()=>loadedStart(), 1000)","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.Logging;","import getLoggerFactory from \"@darkholme/foundry-react-core/src/Util/Logging\";\r\n\r\nconst LoggerFactory = getLoggerFactory(\"MorrowinDnD\")\r\n\r\nexport default function getLogger(feature) {\r\n    return LoggerFactory(feature)\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.DropHelper;","export default class EnchantConfig {\r\n    get CastableSizes() {\r\n        return [\r\n            new EnchantCastableSize({ charges: 2, label: \"Minor\", weight: 8, difficultyMod: 1 }),\r\n            new EnchantCastableSize({ charges: 5, label: \"Major\", weight: 3, difficultyMod: 2 }),\r\n            new EnchantCastableSize({ charges: 10, label: \"Superior\", weight: 1, difficultyMod: 3 }),\r\n            new EnchantCastableSize({ charges: 15, label: \"Immense\", weight: 0.5, difficultyMod: 5 })\r\n        ];\r\n    }\r\n    getRandomCharge() {\r\n        let chargeTypes = this.CastableSizes;\r\n        let max = chargeTypes.map(x => x.weight).reduce((p, c) => p + c);\r\n        let newRand = Math.random() * max;\r\n        for (let i in chargeTypes) {\r\n            let c = chargeTypes[i];\r\n            if (newRand <= c.weight)\r\n                return c;\r\n            newRand -= c.weight;\r\n        }\r\n        return chargeTypes[0];\r\n    }\r\n    get CastableSpellLevels() {\r\n        return [\r\n            new EnchantCastableSpellLevel({ level: 0, value: 50, weight: 20, difficultyMod: 1 }),\r\n            new EnchantCastableSpellLevel({ level: 1, value: 75, weight: 16, difficultyMod: 2 }),\r\n            new EnchantCastableSpellLevel({ level: 2, value: 125, weight: 14, difficultyMod: 4 }),\r\n            new EnchantCastableSpellLevel({ level: 3, value: 700, weight: 10, difficultyMod: 6 }),\r\n            new EnchantCastableSpellLevel({ level: 4, value: 1200, weight: 8, difficultyMod: 8 }),\r\n            new EnchantCastableSpellLevel({ level: 5, value: 4000, weight: 6, difficultyMod: 10 }),\r\n            new EnchantCastableSpellLevel({ level: 6, value: 7000, weight: 4, difficultyMod: 12 }),\r\n            new EnchantCastableSpellLevel({ level: 7, value: 10000, weight: 3, difficultyMod: 15 }),\r\n            new EnchantCastableSpellLevel({ level: 8, value: 14000, weight: 2, difficultyMod: 18 }),\r\n            new EnchantCastableSpellLevel({ level: 9, value: 24000, weight: 1, difficultyMod: 22 }),\r\n        ];\r\n    }\r\n    forSpellLevel(level) {\r\n        return this.CastableSpellLevels.find(l => l.level === level);\r\n    }\r\n    get WeaponDamageUpgrades() {\r\n        return [\r\n            { level: 1, difficultyMod: 2, soulSize: 5, label: \"+1\" },\r\n            { level: 2, difficultyMod: 5, soulSize: 15, label: \"+2\" },\r\n            { level: 3, difficultyMod: 8, soulSize: 35, label: \"+3\" },\r\n            { level: 4, difficultyMod: 11, soulSize: 65, label: \"+4\" },\r\n            { level: 5, difficultyMod: 15, soulSize: 110, label: \"+5\" }\r\n        ];\r\n    }\r\n    get WeaponAttackUpgrades() {\r\n        return [\r\n            { level: 1, difficultyMod: 5, soulSize: 10, label: \"+1\" },\r\n            { level: 2, difficultyMod: 8, soulSize: 35, label: \"+2\" },\r\n            { level: 3, difficultyMod: 11, soulSize: 85, label: \"+3\" },\r\n            { level: 4, difficultyMod: 15, soulSize: 165, label: \"+4\" },\r\n        ];\r\n    }\r\n    get ArmorUpgrades() {\r\n        return [\r\n            { level: 1, difficultyMod: 6, soulSize: 35 },\r\n            { level: 1, difficultyMod: 8, soulSize: 50 },\r\n            { level: 1, difficultyMod: 12, soulSize: 80 },\r\n            { level: 1, difficultyMod: 16, soulSize: 160 },\r\n        ];\r\n    }\r\n    get SoulSizes() {\r\n        return [\r\n            new SoulSize({ label: \"Petty\", size: 5 }),\r\n            new SoulSize({ label: \"Lesser\", size: 20 }),\r\n            new SoulSize({ label: \"Common\", size: 50 }),\r\n            new SoulSize({ label: \"Greater\", size: 100 }),\r\n            new SoulSize({ label: \"Grand\", size: 200 }),\r\n        ];\r\n    }\r\n    static get SoulSizes() {\r\n        return EnchantConfig.instance.SoulSizes;\r\n    }\r\n}\r\nEnchantConfig.instance = new EnchantConfig();\r\nexport class EnchantCastableSize {\r\n    constructor(data) {\r\n        Object.assign(this, data);\r\n    }\r\n}\r\nexport class EnchantCastableSpellLevel {\r\n    constructor(data) {\r\n        Object.assign(this, data);\r\n    }\r\n}\r\nexport class SoulSize {\r\n    constructor(data) {\r\n        Object.assign(this, data);\r\n    }\r\n}\r\n","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./ItemViewer.module.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import styles from \"./ItemViewer.module.scss\"\r\n\r\n/**\r\n * @param item {Item}\r\n * @param children\r\n * @param other\r\n * @returns {JSX.Element}\r\n * @constructor\r\n */\r\nexport default function ItemViewer({item, children, onClick, ...other}) {\r\n    if(!onClick) onClick = ()=>item.sheet.render(true)\r\n    let image = item?.img || \"icons/svg/mystery-man.svg\"\r\n    let name = item?.name || \"No Item\"\r\n    return <div className={styles.viewer} onClick={onClick} {...other}>\r\n        <img src={image} className={styles.image} />\r\n        <span className={styles.name}>{name}</span>\r\n        {children}\r\n    </div>\r\n}","export const SpellLevelValues = {\r\n    0: { value: 50, weight: 20 },\r\n    1: { value: 75, weight: 16 },\r\n    2: { value: 125, weight: 14 },\r\n    3: { value: 700, weight: 10 },\r\n    4: { value: 1200, weight: 8 },\r\n    5: { value: 4000, weight: 6 },\r\n    6: { value: 7000, weight: 4 },\r\n    7: { value: 10000, weight: 3 },\r\n    8: { value: 14000, weight: 2 },\r\n    9: { value: 24000, weight: 1 },\r\n};\r\nexport function calculateEnchantValueAdd(spellLevel, charges) {\r\n    return SpellLevelValues[spellLevel].value * charges;\r\n}\r\n","import { calculateEnchantValueAdd } from \"../Constants/SpellConstants.js\";\r\nimport LoggerFactory from \"../Util/LoggerFactory\";\r\n// @ts-ignore\r\nimport { setupFolder } from \"@darkholme/foundry-react-core/src/Util/FolderHelper\";\r\n// @ts-ignore\r\nimport { isEqual, clone } from '@darkholme/foundry-react-core/src/Util/Util';\r\nconst log = LoggerFactory(\"Enchanter\");\r\nexport const Minor = { charges: 2, label: \"Minor\", weight: 8 };\r\nexport const Major = { charges: 5, label: \"Major\", weight: 3 };\r\nexport const Superior = { charges: 10, label: \"Superior\", weight: 1 };\r\nexport const Immense = { charges: 15, label: \"Immense\", weight: 0.5 };\r\nexport const ChargeTypes = [Minor, Major, Superior, Immense];\r\nexport function getRandomCharge() {\r\n    let max = ChargeTypes.map(x => x.weight).reduce((p, c) => p + c);\r\n    let newRand = Math.random() * max;\r\n    for (let i in ChargeTypes) {\r\n        let c = ChargeTypes[i];\r\n        if (newRand <= c.weight)\r\n            return c;\r\n        newRand -= c.weight;\r\n    }\r\n    return Minor;\r\n}\r\nconst valueRarity = [\r\n    { name: \"Common\", valueMin: 0 },\r\n    { name: \"Uncommon\", valueMin: 300 },\r\n    { name: \"Rare\", valueMin: 1000 },\r\n    { name: \"Very Rare\", valueMin: 10000 },\r\n    { name: \"Legendary\", valueMin: 20000 },\r\n    { name: \"Artifact\", valueMin: 50000 },\r\n];\r\nfunction getRarity(value) {\r\n    let result = valueRarity[0];\r\n    for (let x of valueRarity) {\r\n        if (value >= x.valueMin) {\r\n            result = x;\r\n        }\r\n    }\r\n    return result.name;\r\n}\r\nexport function getEnchantData({ itemData, charges, spellData }) {\r\n    let enchantData = { item: itemData._id, charges: charges, spell: spellData._id };\r\n    let newName = `${itemData.name} of ${charges.label} ${spellData.name}`;\r\n    log(`Enchanting item ${newName}`, itemData, charges, spellData);\r\n    let spellLevel = spellData.data.level;\r\n    let newValue = Math.floor((itemData.data.price * 1.2) + calculateEnchantValueAdd(spellLevel, charges.charges));\r\n    let nestedData = {\r\n        ...spellData.data,\r\n        description: { value: `${itemData.data.description.value}<br/><br/>${spellData.data.description.value}`, chat: \"\", unidentified: `${itemData.data.description.value}<br/><br/>Unknown enchantment` },\r\n        consumableType: \"trinket\",\r\n        weight: itemData.data.weight,\r\n        price: newValue,\r\n        quantity: 1,\r\n        uses: { value: charges.charges, max: charges.charges, per: \"day\" },\r\n        armor: itemData.data.armor,\r\n        rarity: getRarity(newValue)\r\n    };\r\n    let newData = {\r\n        name: newName,\r\n        permission: itemData.permission,\r\n        type: \"consumable\",\r\n        data: nestedData,\r\n        img: itemData.img,\r\n        flags: {\r\n            \"morrowindnd\": {\r\n                \"enchanter_data\": enchantData\r\n            }\r\n        }\r\n    };\r\n    return newData;\r\n}\r\nexport function isSpellEnchantable(itemData) {\r\n    return itemData.type === \"equipment\" && !itemData.flags?.morrowindnd?.enchanter_data;\r\n}\r\nexport async function enchantWeapon({ item, weaponEnchant, renderSheet = true }) {\r\n    let enchantData = { item: item.id, weaponEnchant };\r\n    let existing = game.items.find(i => {\r\n        let enchantedData = i.getFlag(\"morrowindnd\", \"enchanter_data\");\r\n        return isEqual(enchantData, enchantedData);\r\n    });\r\n    if (existing) {\r\n        return existing;\r\n    }\r\n    let folderId = await setupFolder(`MorrowinDnD/Enchanted Items/Weapons`);\r\n    let newData = clone(item.data);\r\n    newData.folder = folderId;\r\n    newData._id = null;\r\n    weaponEnchant.apply(newData);\r\n    log(\"Creating \" + newData.name, item, weaponEnchant, newData);\r\n    let newItem = await Item.create(newData, { temporary: false, renderSheet });\r\n    await newItem.setFlag(\"morrowindnd\", \"enchanter_data\", enchantData);\r\n    return newItem;\r\n}\r\n","import {useContext, useState} from \"react\";\r\nimport {onDrop} from \"@darkholme/foundry-react-core/src/Util/DropHelper\";\r\nimport AppContext from \"@darkholme/foundry-react-core/src/Util/AppContext\";\r\n\r\nimport EnchantConfig from \"./EnchantConfig\";\r\nimport ItemViewer from \"../Util/ItemViewer\";\r\nimport Selector from \"../Util/Selector\";\r\nimport {getEnchantData} from \"./Enchanter\";\r\n\r\n\r\n/**\r\n * @param item {Item}\r\n * @constructor\r\n */\r\nexport default function EnchantingFormComponent({item}) {\r\n    let ItemClass = item.constructor\r\n    let sizes = EnchantConfig.instance.CastableSizes\r\n    let App = useContext(AppContext)\r\n    let [spell, setSpell] = useState(null)\r\n    let [charges, setCharges] = useState(sizes[0])\r\n    let result = (spell && item) ? new ItemClass(getEnchantData({itemData: item.data, spellData: spell.data, charges})) : null\r\n    let onDropped = onDrop((i)=>{\r\n        if(i instanceof Item && i.type === \"spell\") {\r\n            setSpell(i)\r\n        }\r\n    })\r\n    return <div>\r\n        Item to Enchant:\r\n        <ItemViewer item={item} />\r\n        Spell to Enchant:\r\n        <ItemViewer item={spell} onDrop={onDropped} />\r\n        Charges:\r\n        <Selector values={sizes} value={charges} setValue={setCharges} labelFunction={(x)=>`${x.label} - ${x.charges}`} />\r\n        Result:\r\n        <ItemViewer item={result} />\r\n        <button disabled={result == null} onClick={async ()=>{\r\n            await Item.create(result.data, {renderSheet: true})\r\n            App.close()\r\n        }}>Create</button>\r\n    </div>\r\n\r\n}","import getLogger from \"../Util/LoggerFactory\";\r\nimport {SimpleReactApplication} from \"@darkholme/foundry-react-core/src/Util/ReactApplication\";\r\nimport EnchantingFormComponent from \"./EnchantingFormComponent\";\r\nimport {isSpellEnchantable} from \"./Enchanter\";\r\n\r\nconst log = getLogger(\"EnchantForm\")\r\n\r\nfunction canFix(item) {\r\n\tlet {value, max, per} = item.data.data.uses || {value: 0, max:0, per:\"\"} \r\n\tif(item.data.type === \"equipment\" && max > 0 && per == \"day\") {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nHooks.on(\"itemSheetMenuItems\", async (addMenuItem, app)=>{\r\n\tlet item = app.object\r\n\tif(game.user.isGM && isSpellEnchantable(item.data)) {\r\n\t\taddMenuItem({\r\n\t\t\tname: \"Set Enchant\",\r\n\t\t\ticon: '<i class=\"fas fa-hand-sparkles\"></i>',\r\n\t\t\tcallback: ()=>{\r\n\t\t\t\tlog(\"Creating Enchantment Form\", item)\r\n\t\t\t\tnew SimpleReactApplication(<EnchantingFormComponent item={item}/>, {width:300, height: 260}).render(true)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tif(item.owner && canFix(item)) {\r\n\t\taddMenuItem({\r\n\t\t\tname: \"Fix\",\r\n\t\t\ticon: '<i class=\"fas fa-hammer\"></i>',\r\n\t\t\tcallback: async ()=>{\r\n\t\t\t\tlog(\"Fix Item\", item)\r\n\t\t\t\tawait item.update({\"type\": \"consumable\", \"data.consumableType\": \"trinket\"})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n})","import EnchantConfig from \"../EnchantConfig\";\r\nimport Selector from \"../../Util/Selector\";\r\n\r\nexport default function SoulGemPropertiesComponent({soulGemState, setSoulGemState}) {\r\n    let SoulSizes = EnchantConfig.instance.SoulSizes\r\n\r\n    let isSoulGem = soulGemState?.isSoulGem || false\r\n    let size = soulGemState?.size || \"Petty\"\r\n    let sizeObj = SoulSizes.find(x=>x.label === size)\r\n    let fillSize = soulGemState?.fillSize || null\r\n    let fillSizeObj = SoulSizes.find(x=>x.label === fillSize)\r\n    return <div>\r\n        Is Soul Gem: <input type=\"checkbox\" checked={isSoulGem} onChange={(e)=>setSoulGemState({size, isSoulGem: e.target.checked})} />\r\n        Size: <Selector values={SoulSizes} value={sizeObj} setValue={(v)=>setSoulGemState({...soulGemState, size: v.label})} labelFunction={v=>v.label} />\r\n        Filled: <Selector values={SoulSizes} value={fillSizeObj} setValue={(v)=>setSoulGemState({...soulGemState, fillSize: v?.label})} labelFunction={v=>v?.label || \"\"} includeNull />\r\n    </div>\r\n}","import {useContext, useState} from \"react\";\r\nimport SoulGemPropertiesComponent from \"../Enchanting/SoulGems/SoulGemPropertiesComponent\";\r\nimport AppContext from \"@darkholme/foundry-react-core/src/Util/AppContext\";\r\n\r\nexport default function ItemPropertiesComponent({flag, setFlag}) {\r\n    let app = useContext(AppContext)\r\n    let [state, setState] = useState(flag || {})\r\n    return <div>\r\n        <div>\r\n            Soul Gem:\r\n            <SoulGemPropertiesComponent soulGemState={state?.soulGem} setSoulGemState={(v)=>{setState({...state, soulGem: v})}} />\r\n        </div>\r\n        <button onClick={async ()=>{\r\n            await setFlag(state)\r\n            app.close()\r\n        }}>Save</button>\r\n    </div>\r\n}","// @ts-ignore\r\nimport { getFlag } from \"../Util/FlagHelper\";\r\nexport const ITEM_FLAG = \"extra_properties\";\r\nexport function getProperties(item) {\r\n    return getFlag(item, ITEM_FLAG, {});\r\n}\r\n","export function getFlag(object, flag, defaultFlag) {\r\n    let flagObj = object.getFlag(\"morrowindnd\", flag) || defaultFlag;\r\n    let setFlag = (newFlag) => object.setFlag(\"morrowindnd\", flag, newFlag);\r\n    return [flagObj, setFlag];\r\n}\r\n","import {getFlag} from \"../../Util/FlagHelper\";\r\nimport {SimpleReactApplication} from \"@darkholme/foundry-react-core/src/Util/ReactApplication\";\r\nimport ItemPropertiesComponent from \"../../Item/ItemPropertiesComponent\";\r\nimport {fillActorSoulGem} from \"./SoulGemHelper\";\r\n\r\nHooks.on(\"actorSheetMenuItems\", async (addMenuItem, app)=>{\r\n    let item = app.object\r\n    if(game.user.isGM) {\r\n        addMenuItem({\r\n            name: \"Soul Steal\",\r\n            icon: '<i class=\"fas fa-hand-sparkles\"></i>',\r\n            callback: ()=>{\r\n                let targets = game.user.targets\r\n                targets.forEach((target)=>{\r\n                    let actor = target.actor\r\n                    fillActorSoulGem(item, actor)\r\n                })\r\n            }\r\n        })\r\n    }\r\n})","import EnchantConfig from \"../EnchantConfig\";\r\nimport { getProperties, ITEM_FLAG } from \"../../Item/ItemProperties\";\r\nexport function isSoulGem(item) {\r\n    let [data] = getProperties(item);\r\n    if (data?.soulGem?.isSoulGem) {\r\n        let { soulGem } = data;\r\n        let size = EnchantConfig.SoulSizes.find(x => x.label === soulGem.size);\r\n        let fillSize = EnchantConfig.SoulSizes.find(x => x.label === soulGem.fillSize);\r\n        if (size) {\r\n            return { size, fillSize };\r\n        }\r\n    }\r\n}\r\nasync function fillSoulGem(item, size) {\r\n    let [data, setData] = getProperties(item);\r\n    if (data?.soulGem?.isSoulGem) {\r\n        let { soulGem } = data;\r\n        let newSoulGem = { ...soulGem, fillSize: size.label };\r\n        await setData({ ...data, soulGem: newSoulGem });\r\n    }\r\n}\r\nexport async function fillActorSoulGem(actor, deadActor) {\r\n    let soulSize = getSoulLevel(deadActor);\r\n    let gem = actor.items.find(item => {\r\n        let soulInfo = isSoulGem(item);\r\n        if (soulInfo && !soulInfo.fillSize) {\r\n            return soulInfo.size.size >= soulSize.size;\r\n        }\r\n        return false;\r\n    });\r\n    if (gem) {\r\n        let qty = gem.data.data.quantity || 1;\r\n        if (qty > 1) {\r\n            await gem.update({ \"data.quantity\": qty - 1 });\r\n        }\r\n        else {\r\n            await actor.deleteOwnedItem(gem.id);\r\n        }\r\n        let newGemData = {\r\n            ...gem.data,\r\n            name: `Filled ${gem.name} - (${soulSize.label} - ${deadActor.name})`,\r\n            data: {\r\n                ...gem.data.data,\r\n                quantity: 1\r\n            }\r\n        };\r\n        newGemData.flags.morrowindnd[ITEM_FLAG].soulGem.fillSize = soulSize.label;\r\n        await actor.createOwnedItem(newGemData);\r\n    }\r\n}\r\nexport function getSoulLevel(actor) {\r\n    let data = actor.data.data;\r\n    let cr = data.details?.cr || 0;\r\n    let type = data.details?.type || \"\";\r\n    if (type.toLowerCase().includes(\"humanoid\")) {\r\n        return null;\r\n    }\r\n    else {\r\n        if (cr <= 2)\r\n            return EnchantConfig.SoulSizes[0];\r\n        if (cr <= 4)\r\n            return EnchantConfig.SoulSizes[1];\r\n        if (cr <= 8)\r\n            return EnchantConfig.SoulSizes[2];\r\n        if (cr <= 16)\r\n            return EnchantConfig.SoulSizes[3];\r\n        return EnchantConfig.SoulSizes[4];\r\n    }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.PackHelper;","// @ts-ignore\r\nimport { clone } from \"@darkholme/foundry-react-core/src/Util/Util\";\r\nimport { getEnchantData, getRandomCharge, isSpellEnchantable } from \"../../Enchanting/Enchanter\";\r\nexport default class TableItemRollData {\r\n    constructor(item) {\r\n        this.item = item;\r\n    }\r\n    applyItemModification(itemData) {\r\n        if (isSpellEnchantable(itemData) && this.item.data.type === \"spell\") {\r\n            let charges = getRandomCharge();\r\n            return getEnchantData({ itemData, charges, spellData: this.item.data });\r\n        }\r\n        else {\r\n            return itemData;\r\n        }\r\n    }\r\n    getItemData() {\r\n        return [\r\n            clone(this.item.data)\r\n        ];\r\n    }\r\n    getModifications(actorData) {\r\n        return {};\r\n    }\r\n}\r\n","import LoggerFactory from \"../../Util/LoggerFactory\";\r\n// @ts-ignore\r\nimport { loadPackItems } from \"@darkholme/foundry-react-core/src/Util/PackHelper\";\r\nimport TableItemRollData from \"./TableItemRollData\";\r\nconst log = LoggerFactory(\"TableSpellHelper\");\r\nasync function getAllSpells() {\r\n    let packSpells = await loadPackItems([\"Spells\"], { failOnNoPack: false });\r\n    let byName = {};\r\n    packSpells.forEach(s => byName[s.name] = s);\r\n    game.items.filter(i => i.type === \"spell\")\r\n        .forEach(s => byName[s.name] = s);\r\n    return Object.values(byName);\r\n}\r\nexport default class TableSpellHelper {\r\n    async getRollData({ args, filters, filterItem }) {\r\n        log.debug(\"Getting random spell from pack\", filters);\r\n        let allResults = await getAllSpells();\r\n        let filteredResults = allResults.filter(filterItem);\r\n        log.debug(\"Filtered spells\", filters, filteredResults);\r\n        let spellIndex = Math.floor(Math.random() * filteredResults.length);\r\n        let spell = filteredResults[spellIndex];\r\n        if (args.scroll) {\r\n            spell = await spell.constructor.createScrollFromSpell(spell);\r\n        }\r\n        if (spell) {\r\n            return [new TableItemRollData(spell)];\r\n        }\r\n        else {\r\n            return [];\r\n        }\r\n    }\r\n}\r\n","var CurrencyLevel;\r\n(function (CurrencyLevel) {\r\n    CurrencyLevel[\"pp\"] = \"pp\";\r\n    CurrencyLevel[\"gp\"] = \"sp\";\r\n    CurrencyLevel[\"sp\"] = \"sp\";\r\n    CurrencyLevel[\"cp\"] = \"cp\";\r\n})(CurrencyLevel || (CurrencyLevel = {}));\r\nconst CurrencyLevels = [CurrencyLevel.pp, CurrencyLevel.gp, CurrencyLevel.sp, CurrencyLevel.cp];\r\nconst defaultLevel = \"gp\";\r\nexport class CurrencyItem {\r\n    constructor(values) {\r\n        this.values = values;\r\n    }\r\n    map(fun) {\r\n        let resultObj = {};\r\n        CurrencyLevels.forEach(level => {\r\n            let existing = this.values[level] || 0;\r\n            let result = fun(existing, level);\r\n            resultObj[level] = result;\r\n        });\r\n        return resultObj;\r\n    }\r\n    multiply(amount) {\r\n        return new CurrencyItem(this.map(v => v * amount));\r\n    }\r\n    add(other) {\r\n        let ov = other.values;\r\n        return new CurrencyItem(this.map((v, i) => v + ov[i]));\r\n    }\r\n    isEmpty() {\r\n        return !CurrencyLevels.some(level => {\r\n            return this.values[level];\r\n        });\r\n    }\r\n    getModifications(actorData) {\r\n        let modifications = {};\r\n        let currency = actorData?.data?.currency || {};\r\n        this.map((value, type) => {\r\n            if (!value)\r\n                return;\r\n            let existingValue = (currency[type]?.value || 0);\r\n            let modString = `data.currency.${type}.value`;\r\n            modifications[modString] = existingValue + value;\r\n        });\r\n        return modifications;\r\n    }\r\n    getItemData() {\r\n        return [];\r\n    }\r\n    applyItemModification(itemData) { return itemData; }\r\n    toString() {\r\n        return `CurrencyItem ${JSON.stringify(this.values)}`;\r\n    }\r\n}\r\nexport default class TableGoldHelper {\r\n    async getRollData({ args }) {\r\n        let values = {};\r\n        if (args.roll) {\r\n            values[defaultLevel] = args.roll;\r\n        }\r\n        CurrencyLevels.forEach(level => {\r\n            if (args[level]) {\r\n                values[level] = args[level];\r\n            }\r\n        });\r\n        for (let key in values) {\r\n            let roll = values[key];\r\n            let result = parseInt(new Roll(roll).roll().total);\r\n            values[key] = result;\r\n        }\r\n        return [new CurrencyItem(values)];\r\n    }\r\n}\r\n","import getLogger from \"../../Util/LoggerFactory\";\r\nimport {getSubFolders} from \"@darkholme/foundry-react-core/src/Util/FolderHelper\";\r\n\r\nconst log = getLogger(\"TableHelperUtils\")\r\n\r\nconst rarity = [\"common\", \"uncommon\", \"rare\", \"very rare\", \"legendary\", \"artifact\"]\r\n\r\nfunction getCompareFunction(comparator, target) {\r\n\tswitch(comparator) {\r\n\t\tcase \"=\": return (v)=>v == target;\r\n\t\tcase \"<=\": return (v)=>v <= target;\r\n\t\tcase \">=\": return (v)=>v >= target;\r\n\t\tcase \"<\": return (v)=>v < target;\r\n\t\tcase \">\": return (v)=>v > target;\r\n\t\tcase \"!=\": return  (v)=>v != target\r\n\t\tcase \"  in \": return (v)=>target.split(\",\").includes(v)\r\n\t\tcase \" !in \": return (v)=>!target.split(\",\").includes(v)\r\n\t\tcase \" includes \": return (v)=>v.includes(target)\r\n\t\tcase \" !includes \": return (v)=>!v.includes(target)\r\n\t}\r\n}\r\n\r\nconst specialFilters = {\r\n\t\"lrare\": (target)=>{\r\n\t\tlet index = rarity.indexOf(target.toLowerCase())\r\n\t\tif(index !== -1) {\r\n\t\t\treturn (_,{data:{rarity: v}}) => rarity.indexOf(v.toLowerCase()) !== -1 && rarity.indexOf(v.toLowerCase()) < index\r\n\t\t}\r\n\t},\r\n\t\"rarer\": (target)=>{\r\n\t\tlet index = rarity.indexOf(target.toLowerCase())\r\n\t\tif(index !== -1) {\r\n\t\t\treturn (_,{data:{rarity: v}}) => rarity.indexOf(v.toLowerCase()) !== -1 && rarity.indexOf(v.toLowerCase()) > index\r\n\t\t}\r\n\t},\r\n\t\"inside\": (target) =>{\r\n\t\tlet folders = getSubFolders(target)\r\n\t\treturn (_,itemData)=>folders.includes(itemData.folder)\r\n\t},\r\n\t\"!enchanted\": ()=>{\r\n\t\treturn (_,itemData)=>!itemData.flags.morrowindnd?.enchanter_data\r\n\t},\r\n\t\"enchanted\": ()=>{\r\n\t\treturn (_,itemData)=>itemData.flags.morrowindnd?.enchanter_data\r\n\t}\r\n}\r\n\r\nfunction getFilter(argument) {\r\n\tlet split = argument.match(/^(.+?)(=|<=|>=|<|>| in | !in | includes | !includes |!=)(.+)$/)\r\n\tif(split) {\r\n\t\tlog.debug(\"Found regular filter\", argument, split)\r\n\t\tlet [, field, comparator, target] = split\r\n\t\tlet compareFunction = getCompareFunction(comparator, target)\r\n\t\treturn {field, compareFunction}\r\n\t} else {\r\n\t\tfor(let specialFilterName in specialFilters) {\r\n\t\t\tlet match = argument.match(`^(.*?) ?\\\\$${specialFilterName} ?(.*)$`)\r\n\t\t\tif(match)  {\r\n\t\t\t\tlog.debug(\"Found special filter\", specialFilterName, argument, match)\r\n\t\t\t\tlet [, field, target] = match\r\n\t\t\t\tlet compareFunction = specialFilters[specialFilterName](target)\r\n\t\t\t\treturn {field, compareFunction}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction filterItem(filters) {\r\n\treturn (item)=>{\r\n\t\treturn filters.every(filter=>{\r\n\t\t\tlet {field, compareFunction} = filter\r\n\t\t\tlet propValue = getProperty(item.data, field)\r\n\t\t\treturn compareFunction(propValue, item.data)\r\n\t\t})\t\r\n\t}\r\n}\r\n\r\nexport function parseArguments(args) {\r\n\tlet specialArguments = args.filter(a=>a.startsWith(\"@\"))\r\n\tlet filterArguments = args.filter(a=>!a.startsWith(\"@\")).map(a=>getFilter(a)).filter(a=>a)\r\n\tlet result = {\r\n\t\targs: {},\r\n\t\tfilters: []\r\n\t}\r\n\tspecialArguments.forEach(a=>{\r\n\t\tlet match = a.match(/(.+?)=(.+)/)\r\n\t\tif(match) {\r\n\t\t\tlet [, field, target] = match\r\n\t\t\tfield = field.substring(1)\r\n\t\t\tresult.args[field] = target\r\n\t\t} \r\n\t})\r\n\tfilterArguments.forEach((filter)=>{\r\n\t\tresult.filters.push(filter)\r\n\t})\r\n\tresult.filterItem = filterItem(result.filters)\r\n\tlog.debug(\"Built argument table\", result)\r\n\treturn result\r\n}","export class WeaponEnchantment {\r\n    constructor(data = {}) {\r\n        this.data = data;\r\n    }\r\n    applyItemModification(weaponData) {\r\n        if (weaponData.type !== \"weapon\")\r\n            return;\r\n        let { attackBonus, damageParts, prefix, suffix, valueAdd, valueMult } = this.data;\r\n        if (attackBonus && attackBonus != \"0\") {\r\n            weaponData.data.attackBonus += ` + ${this.data.attackBonus}`;\r\n        }\r\n        if (damageParts) {\r\n            weaponData.data.damage.parts.push(...damageParts);\r\n        }\r\n        if (prefix) {\r\n            weaponData.name = prefix + \" \" + weaponData.name;\r\n        }\r\n        if (suffix) {\r\n            weaponData.name += \" \" + suffix;\r\n        }\r\n        if (valueMult) {\r\n            weaponData.data.price = Math.round(weaponData.data.price * parseFloat(valueMult));\r\n        }\r\n        if (valueAdd) {\r\n            weaponData.data.price += parseInt(valueAdd);\r\n        }\r\n    }\r\n    getItemData() {\r\n        return [];\r\n    }\r\n    getModifications(actorData) {\r\n        return {};\r\n    }\r\n}\r\nexport default class TableWeaponEnchantHelper {\r\n    async getRollData({ args }) {\r\n        let attackBonus = args.attackBonus || \"\";\r\n        let damageParts = [];\r\n        let damages = args.damage || \"\";\r\n        let damageTypes = args.damageType || \"\";\r\n        if (damages != \"\") {\r\n            let damageSplit = damages.split(\",\");\r\n            let damageTypeSplit = damageTypes.split(\",\");\r\n            damageSplit.forEach((damage, index) => {\r\n                let type = damageTypeSplit[index];\r\n                damageParts.push([damage, type]);\r\n            });\r\n        }\r\n        return [new WeaponEnchantment({ ...args, attackBonus, damageParts })];\r\n    }\r\n}\r\n","import LoggerFactory from \"../../Util/LoggerFactory\";\r\nimport TableSpellHelper from \"./TableSpellHelper\";\r\nimport TableGoldHelper from \"./TableGoldHelper\";\r\nimport { parseArguments } from \"./tableHelperUtils\";\r\nimport TableItemHelper from \"./TableItemHelper\";\r\nimport TableWeaponEnchantHelper from \"./TableWeaponEnchantHelper\";\r\nimport TableItemRollData from \"./TableItemRollData\";\r\nimport TableTableHelper from \"./TableTableHelper\";\r\nconst log = LoggerFactory(\"TableHelper\");\r\nconst TextHelpers = {\r\n    \"@Gold\": new TableGoldHelper(),\r\n    \"@Item\": new TableItemHelper(),\r\n    \"@Spells\": new TableSpellHelper(),\r\n    \"@Table\": new TableTableHelper(),\r\n    \"@WeaponEnchant\": new TableWeaponEnchantHelper()\r\n};\r\nfunction getArguments(text) {\r\n    let results = text.match(/\\[([^\\]]+)\\]/g)?.map(text => text.substr(1, text.length - 2)) || [];\r\n    log.debug(\"Found roll helper arguments\", results, text);\r\n    return parseArguments(results);\r\n}\r\nexport async function getRollTableData({ type, text, resultId, collection }) {\r\n    log.debug(\"Getting roll item\", arguments);\r\n    if (type == 0) {\r\n        let call = text.split(/\\s/, 1);\r\n        let helper = TextHelpers[call];\r\n        if (helper) {\r\n            let filters = getArguments(text);\r\n            let result = await helper.getRollData(filters);\r\n            log.debug(\"Found result\", result);\r\n            return result;\r\n        }\r\n        else {\r\n            return [];\r\n        }\r\n    }\r\n    else if (type == 1) {\r\n        return [new TableItemRollData(game.items.get(resultId))];\r\n    }\r\n    else if (type == 2) {\r\n        let pack = game.packs.get(collection);\r\n        return [new TableItemRollData(await pack.getEntity(resultId))];\r\n    }\r\n    else {\r\n        log.error(\"Somehow we got the wrong type\", arguments);\r\n    }\r\n}\r\n","import TableItemRollData from \"./TableItemRollData\";\r\nexport default class TableItemHelper {\r\n    async getRollData({ filterItem }) {\r\n        let items = game.items.filter(filterItem);\r\n        if (items.length > 0) {\r\n            let randomIndex = Math.floor(Math.random() * items.length);\r\n            return [new TableItemRollData(items[randomIndex])];\r\n        }\r\n        else {\r\n            return [];\r\n        }\r\n    }\r\n}\r\n","import doRollTable from \"./TableRoller\";\r\nasync function nAsync(number, generator) {\r\n    let array = Array(number).fill(\" \");\r\n    return await Promise.all(array.map(async () => await generator()));\r\n}\r\nexport default class TableTableHelper {\r\n    async getRollData({ args, filterItem }) {\r\n        if (!args.table) {\r\n            throw Error(\"No @table argument specified\");\r\n        }\r\n        else {\r\n            let table = game.tables.find(t => t.name === args.table);\r\n            if (!table) {\r\n                throw Error(`No table found for name [${args.table}]`);\r\n            }\r\n            else {\r\n                let min = parseInt(args.min || \"0\");\r\n                let results = [];\r\n                if (min) {\r\n                    let i = 0;\r\n                    while (results.length < min && i < 20) {\r\n                        let items = (await doRollTable(table.id)).flatMap(i => i.getItemData()).filter(filterItem);\r\n                        if (items.length > 0) {\r\n                            results.push(...items);\r\n                        }\r\n                        i++;\r\n                    }\r\n                }\r\n                else {\r\n                    let rollString = args.roll || \"1\";\r\n                    let rollResult = new Roll(rollString).roll().total;\r\n                    let resultTables = await nAsync(rollResult, () => doRollTable(table.id));\r\n                    results = resultTables\r\n                        .flatMap(i => i)\r\n                        .flatMap(i => i)\r\n                        .filter(filterItem);\r\n                }\r\n                let max = parseInt(args.max || \"100\");\r\n                return results.slice(0, max);\r\n            }\r\n        }\r\n    }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.AsyncHelper;","import { getRollTableData } from \"./TableHelper\";\r\nimport \"@darkholme/foundry-react-core/src/Util/AsyncHelper\";\r\nimport getLogger from \"../../Util/LoggerFactory\";\r\nconst log = getLogger(\"TableRoller\");\r\nclass EncapsulatingRollData {\r\n    constructor(rolls, modifiers) {\r\n        this.rolls = rolls;\r\n        this.modifiers = modifiers;\r\n    }\r\n    applyItemModification(itemData) {\r\n        this.rolls.forEach(r => r.applyItemModification(itemData));\r\n    }\r\n    getItemData() {\r\n        return this.rolls.flatMap(r => r.getItemData())\r\n            .map(itemData => {\r\n            return this.modifiers.reduce((acc, value) => value.applyItemModification(acc), itemData);\r\n        });\r\n    }\r\n    getModifications(actorData) {\r\n        let map = {};\r\n        this.rolls.forEach(r => {\r\n            this.rolls.forEach(r => {\r\n                let mods = r.getModifications(actorData);\r\n                Object.keys(mods).forEach(key => map[key] = mods[key]);\r\n            });\r\n        });\r\n        return map;\r\n    }\r\n}\r\nexport default async function doRollTable(id) {\r\n    if (!id)\r\n        return;\r\n    let rollTable = game.tables.get(id);\r\n    let { tableId } = (rollTable.getFlag(\"morrowindnd\", \"enchant_spells\") || {});\r\n    let roll = rollTable.roll();\r\n    let results = (await Promise.all(roll.results.map(async (result) => {\r\n        return await getRollTableData(result);\r\n    }))).flatMap(i => i);\r\n    log(\"Got results\", results);\r\n    let modifiers = await doRollTable(tableId);\r\n    log(\"Got modifiers\", modifiers);\r\n    if (modifiers) {\r\n        return [new EncapsulatingRollData(results, modifiers)];\r\n    }\r\n    else {\r\n        return results;\r\n    }\r\n}\r\n","import Selector from \"../../Util/Selector\";\r\nimport {useContext, useState} from \"react\";\r\nimport AppContext from \"@darkholme/foundry-react-core/src/Util/AppContext\";\r\n\r\nexport default function TableModifierComponent({flag, setFlag}) {\r\n    let tables = game.tables\r\n    let [table, setTable] = useState(flag?.tableId ? tables.get(flag.tableId) : null)\r\n    let app = useContext(AppContext)\r\n    return <div>\r\n        Roll Table\r\n        <Selector values={tables.entities} value={table} setValue={setTable} labelFunction={t=>t.name} includeNull />\r\n        <button onClick={async ()=>{\r\n            await setFlag({tableId: table.id})\r\n            app.close()\r\n        }}>Save</button>\r\n    </div>\r\n}","import {SimpleReactApplication} from \"@darkholme/foundry-react-core/src/Util/ReactApplication\";\r\nimport getLogger from \"../../Util/LoggerFactory\";\r\nimport doRollTable from \"../Rolling/TableRoller\";\r\nimport TableModifierComponent from \"./TableModifierComponent\";\r\n\r\nconst log = getLogger(\"TableModifier\")\r\n\r\nfunction openTableModifier(table) {\r\n    let flag = table.getFlag(\"morrowindnd\", \"enchant_spells\")\r\n    let setFlag = (v)=>table.setFlag(\"morrowindnd\", \"enchant_spells\", v)\r\n    new SimpleReactApplication(<TableModifierComponent flag={flag} setFlag={setFlag} />, {width: 400, height: 150}).render(true)\r\n}\r\n\r\nHooks.on(\"rollTableConfigMenuItems\", async (addMenuItem, app)=>{\r\n    if(game.user.isGM) {\r\n        addMenuItem({\r\n            name: \"Enchant\",\r\n            icon: '<i class=\"fas fa-hand-sparkles\"></i>',\r\n            callback: ()=>{\r\n                log(\"Opening table\", app.object)\r\n                openTableModifier(app.object)\r\n            }\r\n        })\r\n        addMenuItem({\r\n            name: \"Help\",\r\n            icon: '<i class=\"fas fa-dice\"></i>',\r\n            callback: async ()=>{\r\n                let data = await doRollTable(app.object._id)\r\n                let items = data.flatMap(i=>i.getItemData())\r\n                log(\"Item Rolled\", items, items.map(i=>i instanceof Item ? i.name : i.constructor.name))\r\n            }\r\n        })\r\n    }\r\n})","import doRollTable from \"../../RollTable/Rolling/TableRoller\";\r\nimport getLogger from \"../../Util/LoggerFactory\";\r\nconst log = getLogger(\"TokenLootGenerator\");\r\nexport const ACTOR_FLAG = \"extraActorData\";\r\nHooks.on(\"createTokenMutate\", async (update, { actor, token }) => {\r\n    update(async () => {\r\n        let rollTableIds = actor.getFlag(\"morrowindnd\", ACTOR_FLAG)?.rollTableIds || [];\r\n        let rollResult = (await Promise.all(rollTableIds.map(async ({ id: rollTableId, qty }) => {\r\n            let result = new Roll(qty).roll().total;\r\n            let data = await Promise.all(Array(result).fill(\"\").map(() => doRollTable(rollTableId)));\r\n            let flatData = data.flatMap(i => i);\r\n            log.debug(\"Items rolled\", flatData, result);\r\n            return flatData;\r\n        }))).flatMap(i => i);\r\n        let items = rollResult.flatMap(d => d.getItemData()).map(x => new Item(x, null));\r\n        let modifications = {};\r\n        rollResult.map(x => x.getModifications(actor.data)).forEach(modObj => Object.assign(modifications, modObj));\r\n        log(\"Giving NPC items\", token, items, modifications);\r\n        return { \"items\": items, ...modifications };\r\n    });\r\n});\r\n","import {useCallback, useContext, useState} from \"react\";\r\nimport Selector from \"../../Util/Selector\";\r\nimport AppContext from \"@darkholme/foundry-react-core/src/Util/AppContext\";\r\n\r\nexport default function TokenLootSetupComponent({flag, setFlag}) {\r\n    let tables = game.tables\r\n    let [rollTables, setRollTables] = useState(flag?.rollTableIds || [])\r\n    let app = useContext(AppContext)\r\n    let removeTable = useCallback((slot)=>{\r\n        let newRollTables = [...rollTables]\r\n        newRollTables.splice(slot, 1)\r\n        setRollTables(newRollTables)\r\n    }, [rollTables])\r\n    let addTable = useCallback(()=>{\r\n        setRollTables([...rollTables, {id: null, qty: \"1\"}])\r\n    }, [rollTables])\r\n    let updateTable = useCallback((slot, newValue)=>{\r\n        let newTables = [...rollTables]\r\n        newTables[slot] = newValue\r\n        setRollTables(newTables)\r\n    }, [rollTables])\r\n\r\n    return <div>\r\n        {rollTables.map((table, index)=>{\r\n            let rolltable = tables.get(table.id)\r\n            return <div>\r\n                Qty: <input value={table.qty} onChange={(e)=>updateTable(index, {...table, qty: e.target.value})} />\r\n                Table: <Selector values={tables.entities} value={rolltable} setValue={(n)=>updateTable(index, {...table, id: n.id})} labelFunction={n=>n.name} />\r\n                <button onClick={()=>removeTable(index)}>-</button>\r\n            </div>\r\n        })}\r\n        <button onClick={addTable}>+</button>\r\n        <button onClick={async ()=>{\r\n            await setFlag({rollTableIds: rollTables})\r\n            app.close()\r\n        }}>Save</button>\r\n    </div>\r\n}","import {SimpleReactApplication} from \"@darkholme/foundry-react-core/src/Util/ReactApplication\";\r\nimport {ACTOR_FLAG} from \"./TokenLootGenerator\";\r\nimport TokenLootSetupComponent from \"./TokenLootSetupComponent\";\r\n\r\nHooks.on(\"actorSheetMenuItems\", (add, app, html, data)=>{\r\n    let actor = app.object\r\n    if(actor.owner && !actor.isToken && !actor.isPC) {\r\n        add({\r\n            name: \"Loot\",\r\n            icon: '<i class=\"fas fa-utensils\"></i>',\r\n            callback: ()=>{\r\n                let flag = actor.getFlag(\"morrowindnd\", ACTOR_FLAG)\r\n                let setFlag = (newValue)=>actor.setFlag(\"morrowindnd\", ACTOR_FLAG, newValue)\r\n                new SimpleReactApplication(<TokenLootSetupComponent flag={flag} setFlag={setFlag} />, {width: 400, height: 500} ).render(true)\r\n            }\r\n        })\r\n    }\r\n})","const __WEBPACK_NAMESPACE_OBJECT__ = FoundryReactCore.Util.ItemHelper;","import getLogger from \"../../Util/LoggerFactory\";\r\nimport {mergeItemData} from \"@darkholme/foundry-react-core/src/Util/ItemHelper\";\r\n\r\nconst log = getLogger(\"LootSheetCreator\")\r\nconst FLAG = \"LootedFlag\"\r\nconst BlacklistedTypes = [\"class\", \"spell\", \"feat\"]\r\n\r\nfunction isLootSheet(actor) {\r\n    log(\"Sheet\", actor._sheetClass.name)\r\n    return actor.isToken && actor._sheetClass.name === \"LootSheet5eNPC\"\r\n}\r\n\r\nfunction canBeLooted(token, lootContainer) {\r\n    let flag = token.getFlag(\"morrowindnd\", FLAG)\r\n    if(flag) {\r\n        let {container} = flag\r\n        return container === lootContainer.id\r\n    } else {\r\n        return true\r\n    }\r\n}\r\n\r\nfunction getBaseActor(token) {\r\n    return game.actors.get(token.data.actorId)\r\n}\r\n\r\nfunction getCurrency(token) {\r\n    return token.data.actorData?.data?.currency?.gp?.value || 0\r\n}\r\n\r\nasync function lootTokens(lootContainer, tokens) {\r\n    log.debug(\"Looting Tokens\", lootContainer, tokens)\r\n    let items = tokens.flatMap(token=>{\r\n        let actor = getBaseActor(token)\r\n        let tokenItems = token.actor.items || []\r\n        return tokenItems\r\n            .filter(i=>!actor.items.get(i.id))\r\n            .filter(i=>!BlacklistedTypes.includes(i.type))\r\n            .map(i=>i.data)\r\n    })\r\n    let mergedItems = mergeItemData(items)\r\n    let currency = tokens.map(token=>getCurrency(token)).reduce((p,c)=>p+c, 0)\r\n    await tokens.forEachAsync((token)=>token.setFlag(\"morrowindnd\", FLAG, {container: lootContainer.id}))\r\n    await lootContainer.token.update({\"actorData.items\": [], \"actorData.data.currency.gp.value\": currency})\r\n    await lootContainer.createOwnedItem(mergedItems)\r\n}\r\n\r\nHooks.on(\"actorSheetMenuItems\", (add, app)=>{\r\n    let actor = app.object\r\n    if(game.user.isGM) {\r\n        if(isLootSheet(actor)) {\r\n            add({\r\n                name: \"Loot Tokens\",\r\n                icon: '<i class=\"fas fa-shopping-bag\"></i>',\r\n                callback: async ()=>{\r\n                    let selected = canvas.tokens.controlled\r\n                        .filter(t=>canBeLooted(t, actor))\r\n                        .filter(t=>t.actor !== actor)\r\n                        .filter(t=>!t.actor.isPC)\r\n                    await lootTokens(actor, selected)\r\n                }\r\n            })\r\n        }\r\n        if(actor.isToken && actor.token.getFlag(\"morrowindnd\", FLAG)) {\r\n            add({\r\n                name: \"Reset Loot Status\",\r\n                icon: '<i class=\"fas fa-shopping-bag\"></i>',\r\n                callback: async ()=>{\r\n                    await actor.token.unsetFlag(\"morrowindnd\", FLAG)\r\n                }\r\n            })\r\n        }\r\n    }\r\n})","import getLogger from \"../Util/LoggerFactory\";\r\n\r\nconst log = getLogger(\"TokenTraitModifier\")\r\n\r\nlet traits = {\r\n    \"dunmer\": ()=>({\"actorData.data.traits.dr.value\": [\"fire\"]}),\r\n    \"nord\": ()=>({\"actorData.data.traits.dr.value\": [\"cold\"]}),\r\n    \"heavy\": (actor)=>({\"actorData.data.attributes.ac.value\": actor.data.data.attributes.ac.value + 2})\r\n}\r\n\r\nHooks.on(\"createTokenMutate\", async (update, {token, actor})=>{\r\n    update(async ()=>{\r\n        let image = token.img.replace(/.*\\//, \"\")\r\n        let matchedTraits = Object.keys(traits).filter((traitName)=>image.indexOf(traitName) !== -1)\r\n        log.debug(\"Matching traits\", image, matchedTraits)\r\n        let updateData = {}\r\n        matchedTraits.forEach(traitName=>{\r\n            let trait = traits[traitName](actor)\r\n            Object.assign(updateData, trait)\r\n        })\r\n        updateData[\"actorData.img\"] = token.img\r\n        log(\"Adding traits\", matchedTraits, updateData)\r\n        return updateData\r\n    })\r\n})","import {SimpleReactApplication} from \"@darkholme/foundry-react-core/src/Util/ReactApplication\";\r\nimport ItemPropertiesComponent from \"./ItemPropertiesComponent\";\r\nimport {getFlag} from \"../Util/FlagHelper.ts\";\r\nimport {getProperties} from \"./ItemProperties\";\r\n\r\nHooks.on(\"itemSheetMenuItems\", async (addMenuItem, app)=>{\r\n    let item = app.object\r\n    if(game.user.isGM) {\r\n        addMenuItem({\r\n            name: \"Set Properties\",\r\n            icon: '<i class=\"fas fa-hand-sparkles\"></i>',\r\n            callback: ()=>{\r\n                let [flag, setFlag] = getProperties(item)\r\n                new SimpleReactApplication(<ItemPropertiesComponent flag={flag} setFlag={setFlag}/>, {width:500, height: 600}).render(true)\r\n            }\r\n        })\r\n    }\r\n})"],"sourceRoot":""}